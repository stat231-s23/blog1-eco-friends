---
title: "Health At Fast Food Restaurants"
author: "Cora, Sophia, Wendy"
date: "Add a date"
output:
  rmdformats::readthedown:
    highlight: "kate"
---

```{r setup, include = FALSE}
# Set code chunk defaults 
# Consider adding `message = FALSE` option
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE) 
                      
# Set R environment options
options(knitr.kable.NA = '')

# Load packages
library(tidyverse)
library(kableExtra)
library(rvest)
library(stringr)
library(broom)
library(GGally)
library(ggrepel)

#Loading In our data
nutritional_data <-  read.csv("data/nutritioninfo.csv")

#McDonald's Data Set For 2-way clusters
mcd_nutrition <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")%>%
  select(item, protein, calories)

#McDonald's Data Set for all variables
mcd_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")

#Dairy Queen Data Set for 2-way clusters
dq_nutrition <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")%>%
  select(item, protein, calories)

#Dairy Queen Data Set for all variables
dq_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")

#Sonic Data set
sonic_nutrition <- nutritional_data %>%
   filter(restaurant == "Sonic")%>%
  select(item, protein, calories)

#Sonic Data Set for all variables
sonic_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Sonic")

#Arby's Data Set For 2-way clusters
arb_nutrition <- nutritional_data %>%
  filter(restaurant == "Arbys")%>%
  select(item, protein, calories)

#Arby's Data Set for all variables
arb_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Arbys")

#Burger King Data Set for 2-way clusters
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")%>%
  select(item, protein, calories)

#Burger King Data Set for all variables
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")

#Chick Fila Data set
chf_nutrition <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")%>%
  select(item, protein, calories)

#Chick Fila Data Set for all variables
chf_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")

```



# Arbys

```{r}
arb_clusters_data <- arb_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 4
arb_clusters_4 <- arb_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

arb_clusters_c4 <- augment(arb_clusters_4, arb_nutrition)

ggplot(arb_clusters_c4, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = arb_clusters_c4, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Arby's Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1200)) +
      ylim(c(0,75))

#Get Important Data Points and What items are in which cluster
arb_summaries <- tidy(arb_clusters_4)
arb_summaries

arb_clusters_4$centers

cluster_list <- split(arb_nutrition$item, arb_clusters_4$cluster)
cluster_list
```




# Burger King

```{r}
bk_clusters_data <- bk_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
bk_clusters_3 <- bk_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

bk_nutrition <- bk_nutrition %>%
drop_na
  
bk_clusters_c3 <- augment(bk_clusters_3, bk_nutrition)

ggplot(bk_clusters_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = bk_clusters_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Burger King Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,75))

#Get Important Data Points and What items are in which cluster
bk_summaries <- tidy(bk_clusters_3)
bk_summaries

bk_clusters_3$centers

cluster_list <- split(bk_nutrition$item, bk_clusters_3$cluster)
cluster_list
```

# Chick-Fil-A

```{r}
chf_clusters_data <- chf_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
chf_clusters_3 <- chf_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

chf_clusters_c3 <- augment(chf_clusters_3, chf_nutrition)

ggplot(chf_clusters_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = chf_clusters_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Chick-fil-A Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,900)) +
      ylim(c(0,60))

#Get Important Data Points and What items are in which cluster
chf_summaries <- tidy(chf_clusters_3)
chf_summaries

chf_clusters_3$centers

cluster_list <- split(chf_nutrition$item, chf_clusters_3$cluster)
cluster_list
```


# Dairy Queen

## Calories vs Protein

```{r}
#Selecting our two variables
dq_clusters_data <- dq_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
dq_clusers_5 <- dq_clusters_data %>% 
  kmeans(centers = 5, nstart = 20)

dq_clusers_c5 <- augment(dq_clusers_5, dq_nutrition)

ggplot(dq_clusers_c5, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = dq_clusers_c5, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Dairy Queen Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,60))

#Get Important Data Points and What items are in which cluster
dq_summaries <- tidy(dq_clusers_5)
dq_summaries

dq_clusers_5$centers

cluster_list <- split(dq_nutrition$item, dq_clusers_5$cluster)
cluster_list
```



# Mcdonalds

```{r}
#Selecting Variables
mcd_clusters_data <- mcd_nutrition %>% 
  select(calories, protein)%>%
  drop_na


# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
mcd_clusers_4 <- mcd_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

mcd_clusers_c4 <- augment(mcd_clusers_4, mcd_nutrition)

ggplot(mcd_clusers_c4, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = mcd_clusers_c4, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "McDonalds Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,4000)) +
      ylim(c(0,200))

#Get Important Data Points and What items are in which cluster
mcd_summaries <- tidy(mcd_clusers_4)
mcd_summaries

mcd_clusers_4$centers

cluster_list <- split(mcd_nutrition$item, mcd_clusers_4$cluster)
cluster_list


```


# Sonic

```{r}
#Selecting Variables
sonic_clusters_data <- sonic_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
sonic_clusers_3 <- sonic_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

sonic_clusers_c3 <- augment(sonic_clusers_3, sonic_nutrition)

ggplot(sonic_clusers_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = sonic_clusers_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Sonic Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,2500)) +
      ylim(c(0,90))

#Get Important Data Points and What items are in which cluster
sonic_summaries <- tidy(sonic_clusers_3)
sonic_summaries

sonic_clusers_3$centers

cluster_list <- split(sonic_nutrition$item, sonic_clusers_3$cluster)
cluster_list

```


# Subway



# Taco Bell


# Maps




# References

All data sources, any key R packages, and any other sources used in developing your blog should be cited in full in a list of references at the end of your blog. Your blog post should also link to these sources as they are discussed. You may choose any reference style as long as sources are fully cited (try to be consistent!).

Typically, references in R Markdown (and LaTeX) files are [incorporated with a BibTeX database](https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html) (a .bib file). You can try this approach or manually include either a numbered or alphabetized list. 

Columbia University has compiled some guidance on [how to cite data](https://guides.library.columbia.edu/datacitation). Some data sources will give you the citation information to copy and paste. Use the provided citations or citation styles in those cases.

You can list R package citations with the code `citation("packageName")` in the console and then copy (and reformat as needed) the relevant text, e.g.,
```{r}
citation("DT")
```

The following citations are based on the American Statistical Association citation style (not all of these references are used in this document).:


<!-- Textbook -->
Baumer, B. S., Kaplan, D. T., and Horton, N. J. (2021), *Modern Data Science with R* (2nd ed.), Boca Raton, FL: CRC Press.

<!-- Journal article -->
Broman, K. W. and Woo, K. H. (2018), "Data Organization in Spreadsheets," *The American Statistician*, 72:1, 2-10, doi: [10.1080/00031305.2017.1375989](https://doi.org/10.1080/00031305.2017.1375989)

<!-- Website -->
Columbia University Libraries (n.d.), "Data Citation," available at <https://guides.library.columbia.edu/datacitation>.

<!-- Journal article -->
McNamara, A. and Horton N. J. (2018) "Wrangling Categorical Data in R," *The American Statistician*, 72:1, 97-104, doi: [10.1080/00031305.2017.1356375](https://doi.org/10.1080/00031305.2017.1356375).

<!-- Dataset -->
Shah, Syed A. A. (October 2022), "Starbucks Drinks" (Version 1), *Kaggle*, available at <https://www.kaggle.com/datasets/syedasimalishah/starbucks-drinks>.

<!-- R package -->
Xie Y, Cheng J, Tan X (2022). "DT: A Wrapper of the JavaScript Library 'DataTables'," R package version 0.24, available at <https://CRAN.R-project.org/package=DT>.
  


 


