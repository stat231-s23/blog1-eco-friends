---
title: "Health At Fast Food Restaurants"
author: "Cora, Sophia, Wendy"
date: "Add a date"
output:
  rmdformats::readthedown:
    highlight: "kate"
---

```{r setup, include = FALSE}
# Set code chunk defaults 
# Consider adding `message = FALSE` option
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE) 
                      
# Set R environment options
options(knitr.kable.NA = '')

# Load packages
library(tidyverse)
library(kableExtra)
library(rvest)
library(stringr)
library(broom)
library(GGally)
library(ggrepel)

#Loading In our data
nutritional_data <-  read.csv("data/nutritioninfo.csv")

#McDonald's Data Set For 2-way clusters
mcd_nutrition <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")%>%
  select(item, total_fat, calories)

#McDonald's Data Set for all variables
mcd_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")

#Dairy Queen Data Set for 2-way clusters
dq_nutrition <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")%>%
  select(item, total_fat, calories)

#Dairy Queen Data Set for all variables
dq_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")

#Sonic Data set
sonic_nutrition <- nutritional_data %>%
   filter(restaurant == "Sonic")%>%
  select(item, protein, calories)

#Sonic Data Set for all variables
sonic_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Sonic")

#Arby's Data Set For 2-way clusters
arb_nutrition <- nutritional_data %>%
  filter(restaurant == "Arbys")%>%
  select(item, protein, calories)

#Arby's Data Set for all variables
arb_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Arbys")

#Burger King Data Set for 2-way clusters
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")%>%
  select(item, protein, calories)

#Burger King Data Set for all variables
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")

#Chick Fila Data set
chf_nutrition <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")%>%
  select(item, protein, calories)

#Chick Fila Data Set for all variables
chf_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")


# A comment on who did which parts: Instead of labeling each line of code (since there is a lot of code) we each worked on different restaurants and collaborated on ideas and helped eachother our plan.
#Sophia worked on Arbys, Burger King, and Chick-Fil-A, Cora worked on Dairy queen, McDonald's, and Sonic, and Wendy worked on Subway and Taco Bell as well as the map of fast food locations.
```


# Introduction To Our Project
> A statement on what story our project aims to tell



# Arbys

```{r}
arb_clusters_data <- arb_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 4
arb_clusters_4 <- arb_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

arb_clusters_c4 <- augment(arb_clusters_4, arb_nutrition)

ggplot(arb_clusters_c4, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = arb_clusters_c4, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Arby's Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1200)) +
      ylim(c(0,75))

#Get Important Data Points and What items are in which cluster
arb_summaries <- tidy(arb_clusters_4)
arb_summaries

arb_clusters_4$centers

cluster_list <- split(arb_nutrition$item, arb_clusters_4$cluster)

# make into dataframe to print nicely with kable
arb_dat <- matrix(NA
              , nrow=max(arb_summaries$size)
              , ncol=length(arb_summaries$cluster))

for (i in 1:max(arb_clusters_4$cluster)){
  jmax <- length(cluster_list[[i]])
  for (j in 1:jmax)
    arb_dat[j,i] <- cluster_list[[i]][j]
}

arb_dat %>%
  kable(col.names = c("Group 1", "Bring on the calories and protein!"
                      , "Group 3", "If you're on a diet . . ."))
```




# Burger King

```{r}
bk_clusters_data <- bk_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
bk_clusters_3 <- bk_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

bk_nutrition <- bk_nutrition %>%
drop_na
  
bk_clusters_c3 <- augment(bk_clusters_3, bk_nutrition)

ggplot(bk_clusters_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = bk_clusters_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Burger King Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,75))

#Get Important Data Points and What items are in which cluster
bk_summaries <- tidy(bk_clusters_3)
bk_summaries

bk_clusters_3$centers

cluster_list <- split(bk_nutrition$item, bk_clusters_3$cluster)
cluster_list
```

# Chick-Fil-A

```{r}
chf_clusters_data <- chf_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
chf_clusters_3 <- chf_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

chf_clusters_c3 <- augment(chf_clusters_3, chf_nutrition)

ggplot(chf_clusters_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = chf_clusters_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Chick-fil-A Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,900)) +
      ylim(c(0,60))

#Get Important Data Points and What items are in which cluster
chf_summaries <- tidy(chf_clusters_3)
chf_summaries

chf_clusters_3$centers

cluster_list <- split(chf_nutrition$item, chf_clusters_3$cluster)
cluster_list
```


# Dairy Queen

## Calories vs Protein

### Graph of Clusters

```{r}
#Selecting our two variables
dq_clusters_data <- dq_nutrition %>% 
  select(calories, total_fat)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
dq_clusers_5 <- dq_clusters_data %>% 
  kmeans(centers = 5, nstart = 20)

dq_clusers_c5 <- augment(dq_clusers_5, dq_nutrition)

ggplot(dq_clusers_c5, aes(x = calories, y = total_fat)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = dq_clusers_c5, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Dairy Queen Menu Items Grouped Based on Calories and Total Fat",
       x = "Calories",
       y = "Total Fat",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,60))
```


### Information About Clusters
```{r}
#Get Important Data Points and What items are in which cluster
dq_summaries <- tidy(dq_clusers_5)%>%
    rename(Calories = calories, Total_Fat = total_fat, 
           Size = size, Withiness = withinss)

kable(dq_summaries)


cluster_list_dq <- split(dq_nutrition$item, dq_clusers_5$cluster)

# make into dataframe to print nicely with kable
dq_dat <- matrix(NA
              , nrow=max(dq_summaries$Size)
              , ncol=length(dq_summaries$cluster))

for (i in 1:max(dq_clusers_5$cluster)){
  jmax <- length(cluster_list_dq[[i]])
  for (j in 1:jmax)
    dq_dat[j,i] <- cluster_list_dq[[i]][j]
}

dq_dat %>%
  kable(col.names = c("Average For Dairy Queen", "On the Richer Side"
                      , "Most Fatty/Calorie Dense Items", "Lower calorie and Fat Items", "The Few Low Calorie/Fat Items"))
```

### Which Menu Items Should I Order?

> Description of my analysis of the graphs


## Looking Over All The Varibales:

```{r}
#This is for dq (we used 5 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
dq_clusters_data_full <- dq_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

dq_full_scaled <- dq_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
dq_kmean_full_scaled <- dq_full_scaled %>% 
  kmeans(centers = 5, nstart = 20)

#adding the items and restaurants back in
dq_nutrition_full_scaled_clusters <- augment(dq_kmean_full_scaled, dq_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(dq_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```

### What Does This Mean

> Desciption of what this means:


# Mcdonalds

## Calories and Total Fat

### Graphing The Clusters

```{r}
#Selecting Variables
mcd_clusters_data <- mcd_nutrition %>% 
  select(calories, total_fat)%>%
  drop_na


# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
mcd_clusers_4 <- mcd_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

mcd_clusers_c4 <- augment(mcd_clusers_4, mcd_nutrition)

ggplot(mcd_clusers_c4, aes(x = calories, y = total_fat)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = mcd_clusers_c4, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "McDonalds Menu Items Grouped Based on Calories and Total Fat",
       x = "Calories",
       y = "Total Fat",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,4000)) +
      ylim(c(0,200))

```


### Describing the Clusters

```{r}

#Get Important Data Points and What items are in which cluster
mcd_summaries <- tidy(mcd_clusers_4) %>%
    rename(Calories = calories, Total_Fat = total_fat, 
           Size = size, Withiness = withinss)

kable(mcd_summaries)


cluster_list_mcd <- split(mcd_nutrition$item, mcd_clusers_4$cluster)

# make into dataframe to print nicely with kable
mcd_dat <- matrix(NA
              , nrow=max(mcd_summaries$Size)
              , ncol=length(mcd_summaries$cluster))

for (i in 1:max(mcd_clusers_4$cluster)){
  jmax <- length(cluster_list_mcd[[i]])
  for (j in 1:jmax)
    mcd_dat[j,i] <- cluster_list_mcd[[i]][j]
}

mcd_dat %>%
  kable(col.names = c("Average For McDonalds", "The Fattiest and Most Calorie Dense Item on the Menu"
                      , "Least Fatty/Calorie Dense Items", "High Calories and Fat"))

```


### Which Menu Items Should I Order?

> Description of my analysis of the graphs


## Looking Over all The Nutrition Facts:

```{r}
#This for mcdonalds (we used 4 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
mcd_clusters_data_full <- mcd_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

mcd_full_scaled <- mcd_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
mcd_kmean_full_scaled <- mcd_full_scaled %>% 
  kmeans(centers = 5, nstart = 20)

#adding the items and restaurants back in
mcd_nutrition_full_scaled_clusters <- augment(mcd_kmean_full_scaled, mcd_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(mcd_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```

### What Does this Mean:

> A description of what this means:


# Sonic

## Comparing Calories and Protein
 
### Graphing Our Clusters

```{r}
#Selecting Variables
sonic_clusters_data <- sonic_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
sonic_clusers_3 <- sonic_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

sonic_clusers_c3 <- augment(sonic_clusers_3, sonic_nutrition)

ggplot(sonic_clusers_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = sonic_clusers_c3, aes(label = "", color = ""),
             size = 0.1,
             label.r = unit(0.05, "lines"),
             label.size = 0.5,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Sonic Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,2500)) +
      ylim(c(0,90))
```


### Defining The Clusters

```{r}
#Get Important Data Points and What items are in which cluster
sonic_summaries <- tidy(sonic_clusers_3)%>%
    rename(Calories = calories, Protein = protein, 
           Size = size, Withiness = withinss)


kable(sonic_summaries)

cluster_list_sonic <- split(sonic_nutrition$item, sonic_clusers_3$cluster)

# make into dataframe to print nicely with kable
sonic_dat <- matrix(NA
              , nrow=max(sonic_summaries$Size)
              , ncol=length(sonic_summaries$cluster))

for (i in 1:max(sonic_clusers_3$cluster)){
  jmax <- length(cluster_list_sonic[[i]])
  for (j in 1:jmax)
    sonic_dat[j,i] <- cluster_list_sonic[[i]][j]
}

sonic_dat %>%
  kable(col.names = c("Low Calorie and Protein", "Middle Calories and Protein"
                      , "Extremely Calory and Protein Rich"))

```



### Which Menu Items Should I Order?

> Description of my analysis of the graphs

## Looking over all the variables 

```{r}
#This for sonic (we used 3 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
sonic_clusters_data_full <- sonic_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

sonic_full_scaled <- sonic_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
sonic_kmean_full_scaled <- sonic_full_scaled %>% 
  kmeans(centers = 3, nstart = 20)

#adding the items and restaurants back in
sonic_nutrition_full_scaled_clusters <- augment(sonic_kmean_full_scaled, sonic_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(sonic_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))

```

### What Does this Mean:

> A description of what this means:

# Subway



# Taco Bell


# Maps




# References

All data sources, any key R packages, and any other sources used in developing your blog should be cited in full in a list of references at the end of your blog. Your blog post should also link to these sources as they are discussed. You may choose any reference style as long as sources are fully cited (try to be consistent!).

Typically, references in R Markdown (and LaTeX) files are [incorporated with a BibTeX database](https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html) (a .bib file). You can try this approach or manually include either a numbered or alphabetized list. 

Columbia University has compiled some guidance on [how to cite data](https://guides.library.columbia.edu/datacitation). Some data sources will give you the citation information to copy and paste. Use the provided citations or citation styles in those cases.

You can list R package citations with the code `citation("packageName")` in the console and then copy (and reformat as needed) the relevant text, e.g.,
```{r}
citation("DT")
```

The following citations are based on the American Statistical Association citation style (not all of these references are used in this document).:


<!-- Textbook -->
Baumer, B. S., Kaplan, D. T., and Horton, N. J. (2021), *Modern Data Science with R* (2nd ed.), Boca Raton, FL: CRC Press.

<!-- Journal article -->
Broman, K. W. and Woo, K. H. (2018), "Data Organization in Spreadsheets," *The American Statistician*, 72:1, 2-10, doi: [10.1080/00031305.2017.1375989](https://doi.org/10.1080/00031305.2017.1375989)

<!-- Website -->
Columbia University Libraries (n.d.), "Data Citation," available at <https://guides.library.columbia.edu/datacitation>.

<!-- Journal article -->
McNamara, A. and Horton N. J. (2018) "Wrangling Categorical Data in R," *The American Statistician*, 72:1, 97-104, doi: [10.1080/00031305.2017.1356375](https://doi.org/10.1080/00031305.2017.1356375).

<!-- Dataset -->
Shah, Syed A. A. (October 2022), "Starbucks Drinks" (Version 1), *Kaggle*, available at <https://www.kaggle.com/datasets/syedasimalishah/starbucks-drinks>.

<!-- R package -->
Xie Y, Cheng J, Tan X (2022). "DT: A Wrapper of the JavaScript Library 'DataTables'," R package version 0.24, available at <https://CRAN.R-project.org/package=DT>.
  


 


