---
title: "Health At Fast Food Restaurants"
author: "Cora, Sophia, Wendy"
date: "Add a date"
output:
  rmdformats::readthedown: 
    css: "custom.css"
    highlight: "kate"
    eval: "FALSE"
---

```{r setup, include = FALSE}
# Set code chunk defaults 
# Consider adding `message = FALSE` option
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE) 
                      
# Set R environment options
options(knitr.kable.NA = '')

# Load packages
library(tidyverse)
library(kableExtra)
library(rvest)
library(stringr)
library(broom)
library(GGally)
library(ggrepel)
library(mapview)

#Loading In our data
nutritional_data <-  read.csv("data/nutritioninfo.csv")
restmap <-  read.csv("data/restmap.csv")

#--- McDonald's ---
#McDonald's Data Set For 2-way clusters
mcd_nutrition <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")%>%
  select(item, total_fat, calories)

#McDonald's Data Set for all variables
mcd_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Mcdonalds")

#--- Dairy Queen ---
#Dairy Queen Data Set for 2-way clusters
dq_nutrition <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")%>%
  select(item, total_fat, calories)

#Dairy Queen Data Set for all variables
dq_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Dairy Queen")

#--- Sonic ---
#Sonic Data set
sonic_nutrition <- nutritional_data %>%
   filter(restaurant == "Sonic")%>%
  select(item, protein, calories)

#Sonic Data Set for all variables
sonic_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Sonic")

#--- Arby's ---
#Arby's Data Set For 2-way clusters
arb_nutrition <- nutritional_data %>%
  filter(restaurant == "Arbys")%>%
  select(item, protein, calories)

#Arby's Data Set for all variables
arb_nutrition_data <- nutritional_data %>%
  filter(restaurant == "Arbys")

#--- Burger King ---
#Burger King Data Set for 2-way clusters
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")%>%
  select(item, protein, calories)

#Burger King Data Set for all variables
bk_nutrition <- nutritional_data %>%
  filter(restaurant == "Burger King")

#--- Chick Fil-A ---
#Chick Fil-A Data set
chf_nutrition <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")%>%
  select(item, protein, calories)

#Chick Fila Data Set for all variable
chf_nutrition_data <- nutritional_data %>%
   filter(restaurant == "Chick Fil-A")

#--- Subway ---
subway <- nutritional_data %>%
  filter(restaurant == "Subway")

# Remove columns containing characters
subway_nochar <- subway %>%
  select(-c(item,restaurant))

#--- Taco Bell ---
# Taco Bell info
tacobell <- nutritional_data %>%
  filter(restaurant == "Taco Bell")

# Remove columns containing characters
tacobell_nochar <- tacobell %>%
  select(-c(item,restaurant))


# A comment on who did which parts: Instead of labeling each line of code (since there is a lot of code) we each worked on different restaurants and collaborated on ideas and helped each other plan.
#Sophia worked on Arbys, Burger King, and Chick-Fil-A, Cora worked on Dairy queen, McDonald's, and Sonic, and Wendy worked on Subway and Taco Bell as well as the map of fast food locations.
```


# Introduction To Our Project

**Trigger Warning: This blog post discusses eating, food, and nutrition**

Driving down any American city or town, there are fast food restaurants lining the streets. Faced with time constraints from work, childcare, and commuting, many people often turn to convenience foods to save time. Although these restaurants offer a solution to lost time in terms of food preparation and clean up, they simultaneously propose a new problem: a poor diet. According to a 2015 review, fast food is often high in sugar, salt, saturated or trans fats, and many processed preservatives, while also lacking beneficial nutrients.  The goal of this blog is to answer the question: “Which fast food items from various restaurants best fit health-conscious dietary needs?” By categorizing all of the menu items at the most popular fast-food restaurants, we aim to provide readers with information that might influence their next order. Should you find yourself at Arbys, Burger King, Chick-Fil-A, Dairy Queen, McDonald’s, Sonic, Subway, or Taco Bell, we hope that you’ll be equipped with exactly what you need to know in order to stick to your health goals.

For reference, here are the average daily requirements for various types of nutrition:

* **Calories:** 2000-2500 kcal/day for men, and 1600-2000 kcal/day for women.
* **Protein:** 0.8-1.0 g/kg of body weight/day.
* **Carbohydrates:** 45-65% of total daily calories, or at least 130 g/day.
* **Fat:** 20-35% of total daily calories, or at least 20-35 g/day.
* **Cholesterol:** Less than 300 milligrams per day for most adults, and less than 200 milligrams per day for individuals with heart disease or high blood cholesterol levels.
* **Sodium:** Less than 2,300 milligrams per day for most adults, and less than 1,500 milligrams per day for individuals with high blood pressure, kidney disease, or other health conditions.
* **Sugar:** the American Heart Association recommends no more than 25 grams per day for women and 38 grams per day for men.

Our data is from Kaggle and was created for the purpose of analyzing the health of different fast food items. It can be found at this link: (https://www.kaggle.com/datasets/ulrikthygepedersen/fastfood-nutrition), where you can view other variables that were not a part of our analysis if you are interested in exploring further.

A possible limitation of our data analysis is the fact that the nutritional information or availability of certain menu items could differ depending on the location. Our data does not account for this variability. Another limitation is that we focus on two kinds of nutrients at a  time.  It is difficult to get a total picture of health when you are only given enough information to compare two health components. To remedy this, we provide a matrix of plots with comparisons for all our variables at the end of each restaurant’s analysis.

# Arbys

```{r}
arb_clusters_data <- arb_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 4
arb_clusters_4 <- arb_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

arb_clusters_c4 <- augment(arb_clusters_4, arb_nutrition)

ggplot(arb_clusters_c4, aes(x = calories, y = protein, color = .cluster)) + 
  geom_point() +
  geom_text_repel(aes(label = item), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +

  labs(title = "Arby's Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1200)) +
      ylim(c(0,75))

```

### Information About Clusters:
```{r}
#Get Important Data Points and What items are in which cluster
arb_summaries <- tidy(arb_clusters_4)

kable(arb_summaries)

cluster_list_arb <- split(arb_nutrition$item, arb_clusters_4$cluster)

# make into dataframe to print nicely with kable
arb_dat <- matrix(NA
              , nrow=max(arb_summaries$size)
              , ncol=length(arb_summaries$cluster))

for (i in 1:max(arb_clusters_4$cluster)){
  jmax <- length(cluster_list_arb[[i]])
  for (j in 1:jmax)
    arb_dat[j,i] <- cluster_list_arb[[i]][j]
}

arb_dat %>%
  kable(col.names = c("Group 1", "Bring on the calories and protein!"
                      , "Group 3", "If you're on a diet . . .")) %>%
column_spec(1, color = "#F8766D") %>%
column_spec(2, color = "#528c1c") %>%
column_spec(3, color = "#27adad") %>%
column_spec(4, color = "#C77CFF")

```

## Looking Over All The Variables

```{r}
#This is for dq (we used 4 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
arb_clusters_data_full <- arb_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

arb_full_scaled <- arb_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
arb_kmean_full_scaled <- arb_full_scaled %>% 
  kmeans(centers = 4, nstart = 20)

#adding the items and restaurants back in
arb_nutrition_full_scaled_clusters <- augment(arb_kmean_full_scaled, arb_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(arb_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```


# Burger King

```{r}
bk_clusters_data <- bk_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
bk_clusters_3 <- bk_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

bk_nutrition <- bk_nutrition %>%
drop_na
  
bk_clusters_c3 <- augment(bk_clusters_3, bk_nutrition)

ggplot(bk_clusters_c3, aes(x = calories, y = protein, color = .cluster)) + 
  geom_point() +
  geom_text_repel(aes(label = item), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  labs(title = "Burger King Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,75))

```

### Information About Clusters:
```{r}
#Get Important Data Points and What items are in which cluster
bk_summaries <- tidy(bk_clusters_3)

kable(bk_summaries)

cluster_list_bk <- split(bk_nutrition$item, bk_clusters_3$cluster)

# make into dataframe to print nicely with kable
bk_dat <- matrix(NA
              , nrow=max(bk_summaries$size)
              , ncol=length(bk_summaries$cluster))

for (i in 1:max(bk_clusters_3$cluster)){
  jmax <- length(cluster_list_bk[[i]])
  for (j in 1:jmax)
    bk_dat[j,i] <- cluster_list_bk[[i]][j]
}

bk_dat %>%
  kable(col.names = c("Average For Burger King", "On the Richer Side"
                      , "Most Fatty/Calorie Dense Items"))%>%
column_spec(1, color = "#f54242") %>%
column_spec(2, color = "#2abd09")%>%
column_spec(3, color = "#42A7F5")
```

## Looking Over All The Variables

```{r}
#This is for dq (we used 3 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
bk_clusters_data_full <- bk_nutrition %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

bk_full_scaled <- bk_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
bk_kmean_full_scaled <- bk_full_scaled %>% 
  kmeans(centers = 3, nstart = 20)

#adding the items and restaurants back in
bk_nutrition_full_scaled_clusters <- augment(bk_kmean_full_scaled, bk_nutrition) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(bk_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```


# Chick-Fil-A

```{r}
chf_clusters_data <- chf_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
chf_clusters_3 <- chf_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

chf_clusters_c3 <- augment(chf_clusters_3, chf_nutrition)

ggplot(chf_clusters_c3, aes(x = calories, y = protein, color = .cluster)) + 
  geom_point() +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  labs(title = "Chick-fil-A Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,900)) +
      ylim(c(0,60))

```

### Information About Clusters:
```{r}
#Get Important Data Points and What items are in which cluster
chf_summaries <- tidy(chf_clusters_3)

kable(chf_summaries)

cluster_list_chf <- split(chf_nutrition$item, chf_clusters_3$cluster)

# make into dataframe to print nicely with kable
chf_dat <- matrix(NA
              , nrow=max(chf_summaries$size)
              , ncol=length(chf_summaries$cluster))

for (i in 1:max(chf_clusters_3$cluster)){
  jmax <- length(cluster_list_chf[[i]])
  for (j in 1:jmax)
    chf_dat[j,i] <- cluster_list_chf[[i]][j]
}

chf_dat %>%
  kable(col.names = c("Average For Chick-Fil-A", "On the Richer Side"
                      , "Most Fatty/Calorie Dense Items"))%>%
column_spec(1, color = "#f54242") %>%
column_spec(2, color = "#2abd09")%>%
column_spec(3, color = "#42A7F5")
```

## Looking Over All The Variables

```{r}
#This is for dq (we used 3 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
chf_clusters_data_full <- chf_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

chf_full_scaled <- chf_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
chf_kmean_full_scaled <- chf_full_scaled %>% 
  kmeans(centers = 3, nstart = 20)

#adding the items and restaurants back in
chf_nutrition_full_scaled_clusters <- augment(chf_kmean_full_scaled, chf_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(chf_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```

# Dairy Queen

## Calories and Total Fat

### Graphing the Clusters:

```{r}
#Selecting our two variables
dq_clusters_data <- dq_nutrition %>% 
  select(calories, total_fat)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
dq_clusers_5 <- dq_clusters_data %>% 
  kmeans(centers = 5, nstart = 20)

dq_clusers_c5 <- augment(dq_clusers_5, dq_nutrition)

ggplot(dq_clusers_c5, aes(x = calories, y = total_fat, colors = .cluster)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(50)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  labs(title = "Dairy Queen Menu Items Grouped Based on Calories and Total Fat",
       x = "Calories",
       y = "Total Fat",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1280)) +
      ylim(c(0,80))
```


### Information About Clusters:
```{r}
#Get Important Data Points and What items are in which cluster
dq_summaries <- tidy(dq_clusers_5)%>%
    rename(Calories = calories, Total_Fat = total_fat, 
           Size = size, Withiness = withinss)

kable(dq_summaries)


cluster_list_dq <- split(dq_nutrition$item, dq_clusers_5$cluster)

# make into dataframe to print nicely with kable
dq_dat <- matrix(NA
              , nrow=max(dq_summaries$Size)
              , ncol=length(dq_summaries$cluster))

for (i in 1:max(dq_clusers_5$cluster)){
  jmax <- length(cluster_list_dq[[i]])
  for (j in 1:jmax)
    dq_dat[j,i] <- cluster_list_dq[[i]][j]
}

dq_dat %>%
  kable(col.names = c("Average For Dairy Queen", "On the Richer Side"
                      , "Most Fatty/Calorie Dense Items", "Lower Calorie and Fat Items", "The Few Low Calorie/Fat Items"))%>%
column_spec(1, color = "#f54242") %>%
column_spec(2, color = "#528c1c") %>%
column_spec(3, color = "#2abd09")%>%
column_spec(4, color = "#42A7F5")%>%
column_spec(5, color = "#C77CFF")
```

### Which Menu Items Should I Order?:

> While Dairy Queen is most known for their perfect swirls of soft-serve ice cream, many locations have a full fast food menu. In my graph and tables above, all 42 menu items offered at Dairy Queen across the country are grouped together into five different clusters based on their total calories and total fat. The first cluster contains 14 menu items, which are listed under “Average for Dairy Queen” This is labeled this way because these menu items have an average of 568.5714 calories per serving, and 30.64 grams of fat, which is right in the middle for these five groups. If you find yourself at a Dairy Queen and want to feel full and don’t mind consuming a bunch of calories and fat, choosing an item from this list would be a good idea. The second cluster is labeled “On the Richer Side” and these menu items contain an average of 812.5 calories and 49 grams of total fat. These four items contain the second-highest average amount of calories and fat for Dairy Queen. So, if you are at Dairy Queen, and want to have a large meal that is very satisfying, these four items may be a good choice. The third cluster also contains four items, which have an average of 1,085 calories, and 67 grams of total fat. This is labeled “Most Fatty/Calorie Dense Items” because these four items are the items with the highest calories and fat that DQ offers. So, if you plan on ordering any of these four items, I would be informed that you are consuming a lot of fat and a lot of calories. The fourth Cluster is labeled “lower calorie and fat food items” because it contains some of the least rich items on the menu. These items have an average of 340.5556 calories and only 17.611 grams of total fat. These 18 items would be a good choice for anyone who is looking to have a lighter meal and still feel satisfied after eating it. The fifth and final Category is labeled “The Few Low Calorie/Fat Items” and contains the two salads that Dairy Queen has to offer. These two salads have an average of 85 calories and only 1 gram of fat. So, if you are on a diet or want a small snack while at Dairy Queen, these two options are perfect for you. 



## Looking Over All The Variables

```{r}
#This is for dq (we used 5 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
dq_clusters_data_full <- dq_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

dq_full_scaled <- dq_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
dq_kmean_full_scaled <- dq_full_scaled %>% 
  kmeans(centers = 5, nstart = 20)

#adding the items and restaurants back in
dq_nutrition_full_scaled_clusters <- augment(dq_kmean_full_scaled, dq_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(dq_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```

### What Does This Mean:

> Above one can look at the relationship between each of the seven variables that are most important for looking at the health of the food that you are eating. These components are calories, total fat, protein, cholesterol, sodium, total carbs, and sugar. While this graph is a lot to look at, it allows you to focus on two of the variables that matter most to you. For example, if you are most interested in sugar, you can see that almost all of the food items contain the same amount of sugar, so this variable may not be that interesting because it does not change much depending on which food item. Looking at this graph is why total fat and calories are highlighted in the graph above. It is clear that these two have a very high positive linear correlation and the clusters are clearly separated from one another.



# Mcdonalds

## Calories and Total Fat

### Graphing The Clusters:

```{r}
#Selecting Variables
mcd_clusters_data <- mcd_nutrition %>% 
  select(calories, total_fat)%>%
  drop_na


# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
mcd_clusers_4 <- mcd_clusters_data %>% 
  kmeans(centers = 4, nstart = 20)

mcd_clusers_c4 <- augment(mcd_clusers_4, mcd_nutrition)

ggplot(mcd_clusers_c4, aes(x = calories, y = total_fat)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  labs(title = "McDonalds Menu Items Grouped Based on Calories and Total Fat",
       x = "Calories",
       y = "Total Fat",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,2500)) +
      ylim(c(0,160))

```


### Describing the Clusters:

```{r}

#Get Important Data Points and What items are in which cluster
mcd_summaries <- tidy(mcd_clusers_4) %>%
    rename(Calories = calories, Total_Fat = total_fat, 
           Size = size, Withiness = withinss)

kable(mcd_summaries)


cluster_list_mcd <- split(mcd_nutrition$item, mcd_clusers_4$cluster)

# make into dataframe to print nicely with kable
mcd_dat <- matrix(NA
              , nrow=max(mcd_summaries$Size)
              , ncol=length(mcd_summaries$cluster))

for (i in 1:max(mcd_clusers_4$cluster)){
  jmax <- length(cluster_list_mcd[[i]])
  for (j in 1:jmax)
    mcd_dat[j,i] <- cluster_list_mcd[[i]][j]
}

mcd_dat %>%
  kable(col.names = c("Average For McDonalds", "The Fattiest and Most Calorie Dense Item on the Menu"
                      , "Least Fatty/Calorie Dense Items", "High Calories and Fat"))%>%
  column_spec(1, color = "#f54242") %>%
column_spec(2, color = "#528c1c") %>%
column_spec(3, color = "#09bda8") %>%
column_spec(4, color = "#D742F5")

```


### Which Menu Items Should I Order?:

> When someone thinks of American food, McDonald’s is immediately brought to mind. The classic burger and fries, ice cream cone, and chicken nuggets were all perfected by McDonald’s. Almost everyone finds themselves at a Mcdonald’s at some point in their lives, so this diagram and tables should help to make an informed decision when ordering at McDonald’s. The 57 menu items that can be found at McDonald’s are categorized into four different clusters based on calories and total fat. The 22 items in the first cluster labeled “Average for Mcdonalds” and displayed in the graph with the army green color have 714.5455 calories on average and 34.59 average grams of total fat. These items would be good choices for someone that is fairly hungry and wants a hearty meal that is not overly rich. The second cluster labeled “The Fattiest and Most Calorie Dense Item on the Menu, and is labeled in bright green on the graph only contains one item. This item is the 20-piece Buttermilk Crispy Chicken Tenders, which contains 2,430 calories, and 141 grams of fat. This item contains over the daily recommended calories for a person, and over four times the recommended amount of fat per day. So, this item is only recommended for someone looking to share the food with someone else, or someone who needs to consume a lot more calories and fat than the average person. The third cluster is labeled Least Fatty/Calorie dense items and contains 29 menu items. This cluster contains the least fatty items on the menu at McDonald’s, shown in blue on the graph. However, the numbers are still rather high. The average calories for this cluster are 383.79 and the average fat is 17.68. So, if you are looking for the least calorie-dense items at McDonald’s, this is the list for you. The final cluster is labeled High Calories and Fat and is shown in purple on the graph. This cluster contains five items and are the highest in fat and calories besides the one item in the second cluster. These items have an average of 1,444 calories and 79.6 grams of total fat. So, if you are looking for a large and very filling meal, these items are a good choice for you.


## Looking Over all The Nutrition Facts

```{r}
#This for mcdonalds (we used 4 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
mcd_clusters_data_full <- mcd_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

mcd_full_scaled <- mcd_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standardized variables:
set.seed(23)

#clustering
mcd_kmean_full_scaled <- mcd_full_scaled %>% 
  kmeans(centers = 5, nstart = 20)

#adding the items and restaurants back in
mcd_nutrition_full_scaled_clusters <- augment(mcd_kmean_full_scaled, mcd_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(mcd_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))
```

### What Does This Mean:

> While total fat and calories are singled out above, this graph can show you the relationship between seven different health variables that you may be interested in for your health at a fast food restaurant. You can look at the distribution of any of the factors in menu items at Mcdonald's, for example, in cholesterol, you can see that the purple cluster has the lowest cholesterol than green, but then blue and red overlap quite a bit. You can also look at the relationship between two of the variables, for example, if you look at sugar, you can see that there does not appear to be a very strong association between sugar and any of the other variables, which is explained by the fact that most of the menu items are very low in sugar. Looking at total fat and calories, there appears to be a very linear positive relationship, which is why this relationship is highlighted above, but any of the other relationships can be explored here.


# Sonic

## Calories and Protein
 
### Graphing Our Clusters:

```{r}
#Selecting Variables
sonic_clusters_data <- sonic_nutrition %>% 
  select(calories, protein)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
sonic_clusers_3 <- sonic_clusters_data %>% 
  kmeans(centers = 3, nstart = 20)

sonic_clusers_c3 <- augment(sonic_clusers_3, sonic_nutrition)

ggplot(sonic_clusers_c3, aes(x = calories, y = protein)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  labs(title = "Sonic Menu Items Grouped Based on Calories and Protein",
       x = "Calories",
       y = "Protein",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1500)) +
      ylim(c(0,70))
```


### Defining The Clusters:

```{r}
#Get Important Data Points and What items are in which cluster
sonic_summaries <- tidy(sonic_clusers_3)%>%
    rename(Calories = calories, Protein = protein, 
           Size = size, Withiness = withinss)


kable(sonic_summaries)

cluster_list_sonic <- split(sonic_nutrition$item, sonic_clusers_3$cluster)

# make into dataframe to print nicely with kable
sonic_dat <- matrix(NA
              , nrow=max(sonic_summaries$Size)
              , ncol=length(sonic_summaries$cluster))

for (i in 1:max(sonic_clusers_3$cluster)){
  jmax <- length(cluster_list_sonic[[i]])
  for (j in 1:jmax)
    sonic_dat[j,i] <- cluster_list_sonic[[i]][j]
}

sonic_dat %>%
  kable(col.names = c("Low Calorie and Protein", "Middle Calories and Protein"
                      , "Extremely Calorie and Protein Rich"))%>%
  column_spec(1, color = "#f54242") %>%
column_spec(2, color = "#2abd09") %>%
column_spec(3, color = "#42A7F5") 

```


### Which Menu Items Should I Order?:

> Sonic is known for its comedic commercials and unique drive-in setup. However, they also are popular for their greasy fast food. In the graph and tables above, the 53 menu items offered at Sonic are split into three categories based on their calories and protein. The first cluster named, “Low Calorie and Protein” and labeled in green contains the 24 lowest-calorie and protein-rich items on the menu. These items would be a good choice for anyone who is looking for the lightest menu items from Sonic. This cluster has an average calorie count of 377.5 and an average of 18.66 grams of protein. The second cluster, labeled “Middle Calories and Protein” contains the 19 menu items at Sonic that contain the average amount of calories and protein that are offered at Sonic. These items would be a good choice for anyone wanting to leave Sonic to feel full and satisfied and eat plenty of protein to work to fulfill their daily requirement. This cluster is labeled in blue on the graph and has an average of 682.1 calories and 32.789 grams of protein on average. Finally, the last cluster is labeled in purple on the graph and is titled “Extremely Calorie and protein-rich. These 10 menu items are perfect for a customer who is looking to consume a lot of calories and protein. This cluster contains items with an average of 1,146 calories, and 47.6 grams of protein. Hopefully, this list helps you to decide which menu item you would like to order.


## Looking Over All The Variables 

```{r}
#This for sonic (we used 3 clusters before, so we are going to use that again for consistency)
#getting rid of non-numeric variables
sonic_clusters_data_full <- sonic_nutrition_data %>% 
  select(calories, total_fat, protein, cholesterol, sodium, total_carb, sugar)%>%
  drop_na

sonic_full_scaled <- sonic_clusters_data_full %>%
  # Standardize all numeric variables (subtract mean and divide by SD)
  mutate(across(where(is.numeric),  ~scale(.)[,1], .names = "{.col}_scaled")) %>%
  select(calories_scaled, total_fat_scaled, protein_scaled
         , cholesterol_scaled, sodium_scaled, total_carb_scaled, sugar_scaled) %>% 
  drop_na()

#clustering using standarardized variables:
set.seed(23)

#clustering
sonic_kmean_full_scaled <- sonic_full_scaled %>% 
  kmeans(centers = 3, nstart = 20)

#adding the items and restaurants back in
sonic_nutrition_full_scaled_clusters <- augment(sonic_kmean_full_scaled, sonic_nutrition_data) %>% 
  rename(cluster_scaled = .cluster)

#creating the plot
ggpairs(sonic_nutrition_full_scaled_clusters, aes(color = cluster_scaled),
        columns = c("calories", 
                    "total_fat",
                    "protein", 
                    "cholesterol",
                    "sodium",
                    "total_carb",
                    "sugar"),
        upper = list(continuous = "blank")) +
  theme(text = element_text(size = 8))

```

### What Does This Mean:

> Even though the above protein and calories are highlighted as descriptors of which menu items one should order, there is a lot more to consider when thinking about your diet. The graph above showcases the distribution of seven different health indicators. Looking at the distributions of the different clusters is very interesting because you can see that most of the clusters show one that is low, one medium, and one high cluster, except for sodium, and sugar. All the menu items appear to be around the same for sodium, and for sugar, there appears to be One group of items that are lower in sugar and two that are about medium in sugar. It is also interesting to note the relationships between each of the variables. It seems that almost every variable is related to one another in a positive way, with sugar and sodium being the least heavily correlated. Calories and protein are highlighted to be compared, because the distribution of protein is interesting with the first cluster being fairly spread out and in protein, then a giant spike of a lot of items being medium in protein, and then again, a fairly spread out distribution of items on the higher end. If you are interested in a more well-rounded description of the menu items at Sonic, this is a great place to start.


# Subway
## Looking at Calories and Sugar

> In 2020, Ireland’s Supreme Court announced its ruling in a years-long legal battle: “Subway bread is not bread." Under a 1972 law, Ireland deemed that the sugar content of bread cannot exceed 2% of the weight of flour in the dough. Subway bread was found to have a sugar content of about 10%.

> Why is this a problem? In the United States, the average adult consumes an estimated 17 teaspoons of sugar each day. That accounts for 14% of total calorie intake in adults following a 2,000-calorie diet. Consuming too much sugar can increases the risk of obesity, diabetes, and heart disease.
 
```{r}
#Selecting Variables
subway_selected <- subway %>% 
  select(calories, sugar)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
subway_ck <- subway_selected %>% 
  kmeans(centers = 3, nstart = 20)

subway_c <- augment(subway_ck, subway)
```

### Graphing Our Clusters:

```{r, fig.width = 12, fig.height = 8}
ggplot(subway_c, aes(x = calories, y = sugar)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = subway_c, aes(label = ""),
             size = 0.05,
             label.r = unit(0.05, "lines"),
             label.size = NA,
             fill = NA,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Subway Items Grouped By on Calories and Sugar Content",
       x = "Calories",
       y = "Sugar",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1200)) +
      ylim(c(0,40))
```

### Defining The Clusters:

```{r}
#Get Important Data Points and What items are in which cluster
subway_summaries <- tidy(subway_ck)%>%
    rename(Calories = calories, Sugar = sugar, 
           Size = size, Withiness = withinss)


kable(subway_summaries)

clusterlist_subway <- split(subway$item, subway_ck$cluster)

# make into dataframe to print nicely with kable
subway_df <- matrix(NA
              , nrow=max(subway_summaries$Size)
              , ncol=length(subway_summaries$cluster))

for (i in 1:max(subway_ck$cluster)){
  jmax <- length(clusterlist_subway[[i]])
  for (j in 1:jmax)
    subway_df[j,i] <- clusterlist_subway[[i]][j]
}

subway_df %>%
  kable(col.names = c("Mild Calorie, Mild Sugar Content", "High Calorie, High Sugar Content"
                      , "Low Calorie, Low Sugar Content"))

```

```{r}
subway_ck$centers
```


### Which Menu Items Should I Order?:

> Although an order at Subway can be highly customized, the visualizations above take a look at 96 items on their menu. We can split them into three categories based on their calories and sugar content. The first group, "Mild Calorie, Mild Sugar Content", is red on the scatterplot. It's worth noting that, although these options might be good for someone aiming for a calorie-deficit, there is a lot of variabiltiy in the sugar content - so one should choose wisely. This cluster has an average calorie count of 538 and an average of 10 grams of sugar. 

> The second cluster, labeled “High Calorie, High Sugar Content” are items at Subway that you might want to avoid for a more health-conscious diet. These are colored green on our scatterplot. Most notably, the `Footlong Sweet Onion Chicken Teriyaki`is the item with the highest sugar-level. The sugar content in this single item is almost double the suggested daily sugar intake amount. This cluster has an average of 883 calories and 15 grams of sugar on average. 

> Finally, the last cluster is blue on the graph and is titled “Low Calorie, Low Sugar Content". These menu items are perfect for someone who is looking to consume a meal that is light in calories, while staying below the suggested daily sugar intake. The variation in this group is key: there are salads, meat-based sandwiches, and veggie sandwiches. This cluster contains items with an average of 251 calories, and 7 grams of sugar.

```{r}
# Scaling our variables
subway_scaled <- subway_nochar %>%
# Standardize all numeric variables (subtract mean and divide by SD)
mutate(across(where(is.numeric), ~scale(.)[,1], .names = "{.col}_scaled")) %>%
select(calories_scaled, total_fat_scaled, protein_scaled, cholesterol_scaled, 
       sodium_scaled, total_carb_scaled, sugar_scaled) %>%
drop_na()

# Create k-means
subway_kmeans_scaled <- subway_scaled %>%
kmeans(centers = 3, nstart = 20)

# Scale our clusters
subway_c_scaled <- augment(subway_kmeans_scaled, subway_scaled) %>%
rename(cluster_scaled = .cluster)

# Make some visualizations!
ggpairs(subway_c_scaled, aes(color = cluster_scaled),
columns = c("calories_scaled", "total_fat_scaled", "protein_scaled", "cholesterol_scaled", 
       "sodium_scaled", "total_carb_scaled", "sugar_scaled"),
upper = list(continuous = "blank")) +
theme(text = element_text(size = 8))
```

# Taco Bell

```{r}
#Selecting Variables
tacobell_selected <- tacobell %>% 
  select(calories, cholesterol)%>%
  drop_na

# set the seed for reproducibility
set.seed(23)

# Perform k-means clustering with k = 3
tacobell_c <- tacobell_selected %>% 
  kmeans(centers = 3, nstart = 20)

tacobell_c <- augment(tacobell_c, tacobell)
```



```{r, fig.width = 12, fig.height = 8}
ggplot(tacobell_c, aes(x = calories, y = cholesterol)) + 
  geom_point(aes(color = .cluster)) +
  geom_text_repel(aes(label = item, color = .cluster), 
                  size = 2, max.overlaps = 200, show.legend = FALSE) +
  scale_x_continuous(breaks = scales::breaks_width(200)) +
  scale_y_continuous(breaks = scales::breaks_width(25)) +
  # Add centroid labels to plot
  geom_label(data = tacobell_c, aes(label = ""),
             size = 0.05,
             label.r = unit(0.05, "lines"),
             label.size = NA,
             fill = NA,
             label.padding = unit(0.05, "lines"),
             show.legend = FALSE) +
  labs(title = "Taco Bell Items Grouped By on Calories and Cholesterol",
       x = "Calories",
       y = "Cholesterol",
       color = "Cluster") +
  theme_classic() +
  xlim(c(0,1000)) +
      ylim(c(0,85))
```


```{r, message=FALSE}
# Scaling our variables
tacobell_scaled <- tacobell_nochar %>%
# Standardize all numeric variables (subtract mean and divide by SD)
mutate(across(where(is.numeric), ~scale(.)[,1], .names = "{.col}_scaled")) %>%
select(calories_scaled, total_fat_scaled, protein_scaled, cholesterol_scaled, 
       sodium_scaled, total_carb_scaled, sugar_scaled) %>%
drop_na()

# Create k-means
tacobell_kmeans_scaled <- tacobell_scaled %>%
kmeans(centers = 3, nstart = 20)

# Scale our clusters
tacobell_c_scaled <- augment(tacobell_kmeans_scaled, tacobell_scaled) %>%
rename(cluster_scaled = .cluster)

# Make some visualizations!
ggpairs(tacobell_c_scaled, aes(color = cluster_scaled),
columns = c("calories_scaled", "total_fat_scaled", "protein_scaled", "cholesterol_scaled", 
       "sodium_scaled", "total_carb_scaled", "sugar_scaled"),
upper = list(continuous = "blank")) +
theme(text = element_text(size = 8))
```



# Conclusion

```{r, echo=FALSE}
# Generate Map
mapview(restmap, xcol = "longitude", ycol = "latitude", crs = 4269, grid = FALSE, zcol = "name")
```
*Click a point on the map to learn more about the restaurant located there.*


# References

- Appelhans T, Detsch F, Reudenbach C, Woellauer S (2022). _mapview: Interactive
  Viewing of Spatial Data in R_. R package version 2.11.0,
  <https://CRAN.R-project.org/package=mapview>
  
- Pedersen, Ulrik Thyge. “Fastfood Nutrition.” Kaggle, 21 Mar. 2023, https://www.kaggle.com/datasets/ulrikthygepedersen/fastfood-nutrition. 

- Robinson D, Hayes A, Couch S (2023). _broom: Convert Statistical Objects into
  Tidy Tibbles_. R package version 1.0.3,
  <https://CRAN.R-project.org/package=broom>

- Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A,
  Crowley J (2021). _GGally: Extension to 'ggplot2'_. R package version 2.1.2,
  <https://CRAN.R-project.org/package=GGally>
  
- Shahh, Khushi. “Fast Food Restaurants across US.” Kaggle, 31 Aug. 2021, https://www.kaggle.com/datasets/khushishahh/fast-food-restaurants-across-us. 

-  Slowikowski K (2023). _ggrepel: Automatically Position Non-Overlapping Text
  Labels with 'ggplot2'_. R package version 0.9.3,
  <https://CRAN.R-project.org/package=ggrepel>
  
- Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G,
  Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K,
  Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo
  K, Yutani H (2019). “Welcome to the tidyverse.” _Journal of Open Source
  Software_, *4*(43), 1686. doi:10.21105/joss.01686
  <https://doi.org/10.21105/joss.01686>

- Wickham H (2022). _rvest: Easily Harvest (Scrape) Web Pages_. R package
  version 1.0.3, <https://CRAN.R-project.org/package=rvest>

- Wickham H (2022). _stringr: Simple, Consistent Wrappers for Common String
  Operations_. R package version 1.5.0,
  <https://CRAN.R-project.org/package=stringr>
  
- Zhu H (2021). _kableExtra: Construct Complex Table with 'kable' and Pipe
  Syntax_. R package version 1.3.4,
  <https://CRAN.R-project.org/package=kableExtra>
